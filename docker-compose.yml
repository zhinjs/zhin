# ===========================================
# Zhin.js Docker Compose 配置示例
# 用于运行已创建的 Zhin 项目
# ===========================================

services:
  zhin:
    image: ghcr.io/zhinjs/zhin:latest
    container_name: zhin-bot
    restart: unless-stopped
    
    # 环境变量
    environment:
      - NODE_ENV=production
      - TZ=Asia/Shanghai
    
    # 从 .env 文件加载敏感配置
    env_file:
      - .env
    
    # 端口映射
    ports:
      - "8086:8086"
    
    # 挂载项目目录
    volumes:
      # 项目代码
      - .:/app
      # 持久化数据
      - zhin-data:/app/data
      # 缓存 node_modules（加速启动）
      - zhin-modules:/app/node_modules
    
    # 启动命令
    command: start
    
    # 健康检查
    healthcheck:
      test: ["CMD-SHELL", "wget -q --spider http://localhost:8086/api/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

volumes:
  zhin-data:
  zhin-modules:
