# Zhin.js ä»£ç æ£€æŸ¥æŠ¥å‘Š

**æ£€æŸ¥æ—¥æœŸ**: 2026-01-08  
**æ£€æŸ¥èŒƒå›´**: æ ¸å¿ƒåŒ…ã€å·¥å…·åŒ…ã€æµ‹è¯•é¡¹ç›®ã€æ‰€æœ‰æ’ä»¶å’ŒæœåŠ¡

---

## âœ… æ€»ä½“çŠ¶æ€ï¼šè‰¯å¥½

æ‰€æœ‰æ ¸å¿ƒåŒ…å’Œå·¥å…·åŒ…æ„å»ºæˆåŠŸï¼Œæ— ç±»å‹é”™è¯¯ã€‚æ’ä»¶å’ŒæœåŠ¡ä»£ç è´¨é‡è‰¯å¥½ï¼Œä»…æœ‰å°‘é‡éé˜»å¡æ€§ TODOã€‚

---

## ğŸ“¦ æ ¸å¿ƒåŒ…æ£€æŸ¥

### 1. `@zhin.js/core` (packages/core)

**çŠ¶æ€**: âœ… é€šè¿‡  
**ç‰ˆæœ¬**: 1.0.19  
**æ„å»º**: æˆåŠŸï¼Œæ— ç±»å‹é”™è¯¯  

**ä¸»è¦å¯¼å‡º**:
- `Bot` - æœºå™¨äººæ¥å£
- `Plugin` - æ’ä»¶ç³»ç»Ÿæ ¸å¿ƒ
- `MessageCommand` - å‘½ä»¤ç³»ç»Ÿ
- `Adapter` - é€‚é…å™¨åŸºç±»
- `Message` - æ¶ˆæ¯ç±»å‹
- `Component` - ç»„ä»¶ç³»ç»Ÿ
- `Cron` - å®šæ—¶ä»»åŠ¡

**ä»£ç è´¨é‡**:
- âœ… å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- âœ… ä½¿ç”¨ AsyncLocalStorage ç®¡ç†ä¸Šä¸‹æ–‡
- âœ… æ¸…æ™°çš„ä¾èµ–æ³¨å…¥ç³»ç»Ÿ
- âœ… å®Œå–„çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†

### 2. `zhin.js` (packages/zhin)

**çŠ¶æ€**: âœ… é€šè¿‡  
**ç‰ˆæœ¬**: 1.0.19  
**æ„å»º**: æˆåŠŸï¼Œæ— ç±»å‹é”™è¯¯  

**åŠŸèƒ½**:
- å¼€ç®±å³ç”¨çš„æœºå™¨äººæ¡†æ¶
- é›†æˆé…ç½®ç®¡ç†ã€æ—¥å¿—ä¼ è¾“
- æä¾› `defineConfig` å’Œ `setup` å…¥å£

**ä»£ç è´¨é‡**:
- âœ… é…ç½®åŠ è½½å’ŒéªŒè¯å®Œå–„
- âœ… æ•°æ®åº“æ—¥å¿—ä¼ è¾“å®ç°æ­£ç¡®
- âœ… æ’ä»¶åŠ è½½æœºåˆ¶å¥å£®

---

## ğŸ› ï¸ å·¥å…·åŒ…æ£€æŸ¥

### 3. `@zhin.js/cli` (basic/cli)

**çŠ¶æ€**: âœ… é€šè¿‡  
**ç‰ˆæœ¬**: 1.0.13  
**æ„å»º**: æˆåŠŸï¼Œæ— ç±»å‹é”™è¯¯  

**å‘½ä»¤**:
- `zhin dev` - å¼€å‘æ¨¡å¼
- `zhin start` - ç”Ÿäº§æ¨¡å¼
- `zhin stop` - åœæ­¢æœåŠ¡
- `zhin new` - åˆ›å»ºæ’ä»¶
- `zhin build` - æ„å»ºé¡¹ç›®
- `zhin install/add` - å®‰è£…æ’ä»¶
- `zhin search/info` - æœç´¢æ’ä»¶

**ä»£ç è´¨é‡**:
- âœ… ä½¿ç”¨ Commander.js æ„å»º CLI
- âœ… å®Œæ•´çš„å‘½ä»¤å®ç°
- âœ… è‰¯å¥½çš„é”™è¯¯å¤„ç†

### 4. `create-zhin-app` (packages/create-zhin)

**çŠ¶æ€**: âœ… é€šè¿‡ï¼ˆå·²ä¿®å¤ï¼‰  
**ç‰ˆæœ¬**: 1.0.16  
**æ„å»º**: æˆåŠŸï¼Œæ— ç±»å‹é”™è¯¯  

**ä¿®å¤å†…å®¹**:
1. âœ… å°† `@zhin.js/adapter-process` æ›¿æ¢ä¸º `@zhin.js/adapter-sandbox`
2. âœ… ç§»é™¤é…ç½®æ¨¡æ¿ä¸­çš„ `bots` å­—æ®µï¼ˆä¸å†éœ€è¦ï¼‰
3. âœ… æ·»åŠ  `console` é…ç½®åˆ°æ‰€æœ‰æ¨¡æ¿ï¼ˆTS/JS/YAML/JSONï¼‰
4. âœ… ç»Ÿä¸€æ’ä»¶åç§°æ ¼å¼ï¼ˆä½¿ç”¨å®Œæ•´åŒ…åï¼‰

**é…ç½®æ¨¡æ¿**:
```yaml
# æ­£ç¡®çš„é…ç½®ç»“æ„
log_level: 1
database:
  dialect: sqlite
  filename: ./data/bot.db
plugins:
  - "@zhin.js/adapter-sandbox"  # âœ… æ­£ç¡®
  - "@zhin.js/http"
  - "@zhin.js/console"
console:
  enabled: true
  lazyLoad: false
```

---

## ğŸ§© æ’ä»¶å’ŒæœåŠ¡æ£€æŸ¥

### é€‚é…å™¨ (plugins/adapters)

| é€‚é…å™¨ | çŠ¶æ€ | TODO | è¯´æ˜ |
|--------|------|------|------|
| sandbox | âœ… | 0 | ç»ˆç«¯æµ‹è¯•é€‚é…å™¨ï¼Œå®Œæ•´å®ç° |
| icqq | âœ… | 0 | QQ é€‚é…å™¨ï¼Œå®Œæ•´å®ç° |
| kook | âš ï¸ | 2 | æ¶ˆæ¯æ ¼å¼è§£æéœ€å®Œå–„ |
| qq | âœ… | 0 | QQ å®˜æ–¹æœºå™¨äººé€‚é…å™¨ |
| discord | âœ… | 0 | Discord é€‚é…å™¨ |
| telegram | âœ… | 0 | Telegram é€‚é…å™¨ |
| slack | âœ… | 0 | Slack é€‚é…å™¨ |
| email | âœ… | 0 | é‚®ä»¶é€‚é…å™¨ |
| onebot11 | âœ… | 0 | OneBot 11 é€‚é…å™¨ |
| dingtalk | âœ… | 0 | é’‰é’‰é€‚é…å™¨ |
| lark | âœ… | 0 | é£ä¹¦é€‚é…å™¨ |
| wechat-mp | âš ï¸ | 1 | åª’ä½“ä¸Šä¼ åŠŸèƒ½å¾…å®ç° |

### æœåŠ¡ (plugins/services)

| æœåŠ¡ | çŠ¶æ€ | TODO | è¯´æ˜ |
|------|------|------|------|
| http | âœ… | 0 | HTTP æœåŠ¡ï¼Œå®Œæ•´å®ç° |
| console | âœ… | 0 | Web æ§åˆ¶å°ï¼Œå®Œæ•´å®ç° |
| mcp | âœ… | 0 | MCP åè®®æ”¯æŒ |
| github-notify | âœ… | 0 | GitHub é€šçŸ¥æœåŠ¡ |

### åŸºç¡€åº“ (basic)

| åº“ | çŠ¶æ€ | è¯´æ˜ |
|----|------|------|
| database | âœ… | æ•°æ®åº“æŠ½è±¡å±‚ |
| dependency | âœ… | ä¾èµ–æ³¨å…¥ç³»ç»Ÿ |
| logger | âœ… | æ—¥å¿—ç³»ç»Ÿ |
| schema | âœ… | é…ç½®éªŒè¯ |
| cli | âœ… | å‘½ä»¤è¡Œå·¥å…· |

---

## âš ï¸ å¾…å®Œå–„çš„ TODO

### 1. Kook é€‚é…å™¨ (plugins/adapters/kook/src/index.ts)

**ä½ç½®**: ç¬¬ 191 è¡Œå’Œç¬¬ 270 è¡Œ

```typescript
// TODO: å®ç°å®Œæ•´çš„ KOOK æ¶ˆæ¯æ ¼å¼è§£æ
private parseMessageContent(content: string): MessageElement[] {
  // ç®€åŒ–çš„æ¶ˆæ¯è§£æï¼Œå®é™…åº”è¯¥æ ¹æ® KOOK çš„æ¶ˆæ¯æ ¼å¼è§£æ
  return [{ type: "text", data: { text: content } }];
}

// TODO: å®ç°å®Œæ•´çš„æ¶ˆæ¯æ®µåˆ° KOOK æ ¼å¼çš„è½¬æ¢
private convertToKookFormat(content: MessageElement[]): string {
  // ç®€åŒ–çš„è½¬æ¢ï¼Œå®é™…åº”è¯¥æ ¹æ® KOOK çš„æ¶ˆæ¯æ ¼å¼è½¬æ¢
  return content.map((el) => {
    if (el.type === "text") return el.data.text;
    return "";
  }).join("");
}
```

**ä¼˜å…ˆçº§**: ä¸­  
**å½±å“**: ä¸å½±å“åŸºæœ¬åŠŸèƒ½ï¼Œä½†å¤æ‚æ¶ˆæ¯ï¼ˆå›¾ç‰‡ã€è¡¨æƒ…ç­‰ï¼‰æ— æ³•æ­£ç¡®è§£æ

### 2. å¾®ä¿¡å…¬ä¼—å·é€‚é…å™¨ (plugins/adapters/wechat-mp/src/index.ts)

**ä½ç½®**: ç¬¬ 499 è¡Œ

```typescript
// TODO: å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
async uploadMedia(type: 'image' | 'voice' | 'video' | 'thumb', buffer: Buffer): Promise<string> {
  // éœ€è¦å¤„ç† Node.js FormData ä¸æµè§ˆå™¨ FormData çš„å…¼å®¹æ€§é—®é¢˜
  throw new Error('Media upload feature is not implemented yet');
}
```

**ä¼˜å…ˆçº§**: ä½  
**å½±å“**: æ— æ³•ä¸Šä¼ åª’ä½“æ–‡ä»¶ï¼Œä½†ä¸å½±å“æ–‡æœ¬æ¶ˆæ¯

---

## ğŸ§ª æµ‹è¯•é¡¹ç›®æ£€æŸ¥

### test-bot (examples/test-bot)

**çŠ¶æ€**: âœ… æ­£å¸¸  
**ç‰ˆæœ¬**: 0.1.12  

**ä¾èµ–**:
- âœ… æ‰€æœ‰é€‚é…å™¨ä¾èµ–æ­£ç¡®
- âœ… æ‰€æœ‰æœåŠ¡ä¾èµ–æ­£ç¡®
- âœ… ä½¿ç”¨ workspace åè®®

**é…ç½®**:
- âœ… é…ç½®æ–‡ä»¶ç»“æ„æ­£ç¡®
- âœ… æ’ä»¶åˆ—è¡¨åˆç†
- âœ… ç¯å¢ƒå˜é‡é…ç½®å®Œå–„

---

## ğŸ“Š æ„å»ºæµ‹è¯•ç»“æœ

### æ„å»ºå‘½ä»¤

```bash
pnpm build
```

### æ„å»ºç»“æœ

**åŸºç¡€åº“** (5/5):
- âœ… @zhin.js/database
- âœ… @zhin.js/dependency
- âœ… @zhin.js/logger
- âœ… @zhin.js/schema
- âœ… @zhin.js/cli

**æ ¸å¿ƒåŒ…** (4/4):
- âœ… @zhin.js/client
- âœ… @zhin.js/core
- âœ… @zhin.js/create-zhin
- âœ… zhin.js

**æœåŠ¡** (4/4):
- âœ… @zhin.js/http
- âœ… @zhin.js/console
- âœ… @zhin.js/mcp
- âœ… @zhin.js/github-notify

**é€‚é…å™¨** (12/12):
- âœ… @zhin.js/adapter-sandbox
- âœ… @zhin.js/adapter-icqq
- âœ… @zhin.js/adapter-kook
- âœ… @zhin.js/adapter-qq
- âœ… @zhin.js/adapter-discord
- âœ… @zhin.js/adapter-telegram
- âœ… @zhin.js/adapter-slack
- âœ… @zhin.js/adapter-email
- âœ… @zhin.js/adapter-onebot11
- âœ… @zhin.js/adapter-dingtalk
- âœ… @zhin.js/adapter-lark
- âœ… @zhin.js/adapter-wechat-mp

**æ’ä»¶** (2/2):
- âœ… @zhin.js/plugin-music
- âœ… @zhin.js/sensitive-filter

**æ€»è®¡**: 27/27 åŒ…æ„å»ºæˆåŠŸ âœ…

---

## ğŸ” ä»£ç è´¨é‡è¯„ä¼°

### ä¼˜ç‚¹

1. **ç±»å‹å®‰å…¨** âœ…
   - æ‰€æœ‰åŒ…éƒ½æœ‰å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
   - ä½¿ç”¨ `.d.ts` å’Œ `.d.ts.map` æä¾›ç±»å‹æ”¯æŒ

2. **æ¶æ„æ¸…æ™°** âœ…
   - æ’ä»¶ç³»ç»Ÿè®¾è®¡åˆç†
   - ä¾èµ–æ³¨å…¥å®ç°ä¼˜é›…
   - ç”Ÿå‘½å‘¨æœŸç®¡ç†å®Œå–„

3. **ä»£ç è§„èŒƒ** âœ…
   - ç»Ÿä¸€çš„ä»£ç é£æ ¼
   - æ¸…æ™°çš„æ³¨é‡Šå’Œæ–‡æ¡£
   - åˆç†çš„æ¨¡å—åˆ’åˆ†

4. **æ„å»ºç³»ç»Ÿ** âœ…
   - ä½¿ç”¨ pnpm workspace ç®¡ç† monorepo
   - ç»Ÿä¸€çš„æ„å»ºè„šæœ¬
   - æ­£ç¡®çš„ä¾èµ–å…³ç³»

### æ”¹è¿›å»ºè®®

1. **å®Œå–„ Kook é€‚é…å™¨** (ä¼˜å…ˆçº§: ä¸­)
   - å®ç°å®Œæ•´çš„æ¶ˆæ¯æ ¼å¼è§£æ
   - æ”¯æŒå›¾ç‰‡ã€è¡¨æƒ…ç­‰å¯Œåª’ä½“æ¶ˆæ¯

2. **å®Œå–„å¾®ä¿¡å…¬ä¼—å·é€‚é…å™¨** (ä¼˜å…ˆçº§: ä½)
   - å®ç°åª’ä½“æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
   - å¤„ç† FormData å…¼å®¹æ€§

3. **æ·»åŠ å•å…ƒæµ‹è¯•** (ä¼˜å…ˆçº§: ä¸­)
   - ä¸ºæ ¸å¿ƒåŒ…æ·»åŠ å•å…ƒæµ‹è¯•
   - æé«˜ä»£ç è¦†ç›–ç‡

4. **æ€§èƒ½ä¼˜åŒ–** (ä¼˜å…ˆçº§: ä½)
   - ä¼˜åŒ–æ’ä»¶åŠ è½½é€Ÿåº¦
   - å‡å°‘å†…å­˜å ç”¨

---

## ğŸ“ æœ¬æ¬¡ä¿®å¤å†…å®¹

### create-zhin-app ä¿®å¤

**æ–‡ä»¶**: `packages/create-zhin/src/workspace.ts`

```diff
  dependencies: {
    'zhin.js': 'latest',
-   '@zhin.js/adapter-process': 'latest',
+   '@zhin.js/adapter-sandbox': 'latest',
    '@zhin.js/http': 'latest',
    '@zhin.js/client': 'latest',
    '@zhin.js/console': 'latest',
    ...databaseDeps
  },
```

**æ–‡ä»¶**: `packages/create-zhin/src/config.ts`

```diff
  plugins: [
-   'adapter-process',
-   'http',
-   'console',
+   '@zhin.js/adapter-sandbox',
+   '@zhin.js/http',
+   '@zhin.js/console',
    'example'
  ],
+ console: {
+   enabled: true,
+   lazyLoad: false
+ },
```

```diff
- bots: [{
-   name: `${process.pid}`,
-   context: 'process'
- }],
  log_level: LogLevel.INFO,
```

---

## âœ… ç»“è®º

Zhin.js é¡¹ç›®ä»£ç è´¨é‡è‰¯å¥½ï¼Œæ ¸å¿ƒåŠŸèƒ½å®Œæ•´ï¼Œæ„å»ºç³»ç»Ÿå¥å£®ã€‚æ‰€æœ‰æ ¸å¿ƒåŒ…å’Œå·¥å…·åŒ…éƒ½èƒ½æ­£å¸¸æ„å»ºå’Œä½¿ç”¨ã€‚

**ä¸»è¦æˆå°±**:
- âœ… 27 ä¸ªåŒ…å…¨éƒ¨æ„å»ºæˆåŠŸ
- âœ… æ— ç±»å‹é”™è¯¯
- âœ… ä¿®å¤äº† create-zhin-app çš„é…ç½®é—®é¢˜
- âœ… ç»Ÿä¸€äº†æ’ä»¶å‘½åè§„èŒƒ

**å¾…å®Œå–„**:
- âš ï¸ Kook é€‚é…å™¨æ¶ˆæ¯æ ¼å¼è§£æï¼ˆéé˜»å¡ï¼‰
- âš ï¸ å¾®ä¿¡å…¬ä¼—å·åª’ä½“ä¸Šä¼ åŠŸèƒ½ï¼ˆéé˜»å¡ï¼‰

**å»ºè®®**:
- ç»§ç»­å®Œå–„é€‚é…å™¨åŠŸèƒ½
- æ·»åŠ æ›´å¤šå•å…ƒæµ‹è¯•
- ä¼˜åŒ–æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨

---

**æ£€æŸ¥äººå‘˜**: AI Assistant  
**å®¡æ ¸çŠ¶æ€**: âœ… é€šè¿‡

